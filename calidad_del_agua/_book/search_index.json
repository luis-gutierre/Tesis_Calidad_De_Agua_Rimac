[["introduccion.html", "TRABAJO DE CALIDAD DE AGUA RIMAC 1.INTRODUCCION", " TRABAJO DE CALIDAD DE AGUA RIMAC 1.INTRODUCCION Los programas de monitoreo de calidad de agua de instituciones públicas y privadas generan datos de manera transversal, más de dos variables en uno o más puntos de monitoreo, dentro del espacio de influencia de determinado proyecto y longitudinalmente por lo menos dos veces por año, uno en la épocas seca y otro en la época húmeda. Estos conjuntos de datos se pueden organizar en una matriz de datos multivariante, o simplemente matriz de datos, cuando son periódicos en una matriz de series de tiempo, en todos los casos, matrices complejas y multidimensionales. Los datos son valores de medición de variables o parámetros físicos, químicos y biológicos de calidad de agua en diferentes escalas y unidades de medida. El análisis individual de los datos por variable o parámetro ambiental es la forma de evaluación generalizada, tanto en organismos estatales como privados, siendo el objetivo en términos de manejo y regulación ambiental no trasgredir el valor del estándar de calidad ambiental (ECA) del parámetro. Una perspectiva de comparación estática y estacionaria respecto al valor del estándar, donde la finalidad en términos de proximidad es determinar cuan cercanos o alejados del ECA se encuentra la medición de determinada variable, mientras que la variación de dos mediciones en el tiempo de esa misma variable no es tomada en consideración en los informes de monitoreo. El empleo de técnicas estadísticas univariadas podría mejorar la información que subyace en los datos generados, y aún más si los datos fueran tratados de manera conjunta mediante técnicas de estadística multivariante. El enfoque de este estudio obvia el uso y comparación con niveles aceptables de referencia para variables de calidad ambiental del agua, como los estándares o niveles máximos permisibles, no pretende determinar el cumplimiento o trasgresión de los niveles de aceptación de cada variable o parámetro; sino más bien, intenta dar una mirada a las fluctuaciones y/o regularidades que muestran los parámetros de calidad de agua en el tiempo, como un conjunto y parte de un sistema, asumiendo la complejidad y multidimensionalidad de las medidas u observaciones. 2 El análisis conjunto de variables o los elementos físico-químicos y biológicos de la calidad de agua en el sector que corresponde a la bocatoma La Atarjea, cuenca baja del río Rímac, desde las perspectiva multivariante, puede considerarse como una primera aproximación a un enfoque de integridad ecológica, ecosistemas acuáticos, cuyos elementos (variables ambientales) se encuentran interactuando entre sí, manifestando variaciones en el tiempo. Además de ser una herramienta de soporte de medidas de manejo y seguimiento tanto para gestores ambientales como para tomadores de decisiones. El uso de técnicas multivariantes en el análisis de variaciones espacio-temporales de la calidad de agua de cuerpos acuáticos continentales, tanto lénticos como lóticos es una práctica que se ha ido incrementando en las últimas décadas, en la medida que, las herramientas de análisis han ido mejorando e incorporando algoritmos matemáticos más asequibles, comprensibles y específicos para un determinado fin, en programas o paquetes estadísticos comerciales o libres, tanto para la exploración como para la inferencia de datos. En ese mismo sentido ha avanzado la accesibilidad a la literatura científica y sobre todo a los informes de monitoreo donde se presentan los datos o valores de las variables ambientales monitoreadas, un aspecto que era limitante para investigadores que estaban interesados en la dinámica de la calidad del agua, en términos de tiempo y aún más en recursos financieros para la toma de muestras y el análisis en laboratorio. Las técnicas de análisis multivariante tienen como objetivo reducir la complejidad y multidimensionalidad de la matriz de datos a nuevas dimensiones de análisis, lo que permite responder, entre otras cuestiones: ¿Existen evidencias estadísticas de cambios en el tiempo? ¿Cómo es la variación de la calidad del agua en el río Rímac? ¿Existe evidencia estadística de un patrón temporal de calidad de agua? ¿Cuál o cuáles son los parámetros o variables ambientales más importantes que influyen en la dinámica temporal de la calidad del agua? ¿Cuál es la relación entre parámetros? ¿Están todos los parámetros relacionados? La data de estudio ha sido originada por el programa de monitoreo de calidad de agua del río Rímac, en el sector de la bocatoma La Atarjea, de la empresa SEDAPAL. Los datos corresponden a la media mensual de las dos bocatomas existentes y han sido obtenidos mediante el mecanismo de acceso a la información pública. "],["objetivos.html", "2.OBJETIVOS", " 2.OBJETIVOS El objetivo principal de este estudio es determinar patrones de variación temporal de la calidad de agua en el sector de la bocatoma de La Atarjea, Río Rímac. Los objetivos específicos son: 1) Identificar patrones temporales de variación de la calidad de agua. 2) Examinar la variación temporal de cada uno de los parámetros de la calidad de agua. 3) Identificar los parámetros de calidad de agua más importantes o relevantes. 4) Identificar relaciones entre parámetros de calidad de agua. "],["metodos.html", "3.METODOS", " 3.METODOS 3.1 APLICANDO CLUSTER JERARQUICO library(readxl) datosc &lt;- read_excel(&quot;data_media.xlsx&quot;) Estructura: Tenemos 24 variables de formato numerico y 1 variable en formato character(meses) str(datosc) ## tibble [12 x 25] (S3: tbl_df/tbl/data.frame) ## $ meses: chr [1:12] &quot;Ene&quot; &quot;Feb&quot; &quot;Mar&quot; &quot;Abr&quot; ... ## $ Caud : num [1:12] 40.6 56 71.9 47.6 26.3 23.1 23.5 21.7 22.8 22.4 ... ## $ Temp : num [1:12] 19.2 20.2 20.2 20.1 18.5 17.2 16.6 15.7 16.5 18.6 ... ## $ pH : num [1:12] 7.7 7.8 7 7 8 7 7.8 7 7 8 ... ## $ Turb : num [1:12] 47.2 301.9 391.7 100.4 12.5 ... ## $ CE : num [1:12] 488 440 402 426 595 ... ## $ OD : num [1:12] 8.7 8.84 8.94 8.51 8.55 8.64 9 8.76 8.7 8.64 ... ## $ SD : num [1:12] 338 308 278 284 380 ... ## $ Akal : num [1:12] 95.6 91 81.6 91.3 120.4 ... ## $ DI : num [1:12] 211 189 165 176 255 ... ## $ Cls : num [1:12] 14.3 12.8 12.8 11.9 21.8 24.8 18.8 19.3 19.9 17.8 ... ## $ so : num [1:12] 138.6 116.5 97.5 114.6 146.7 ... ## $ N03 : num [1:12] 2.98 2.78 2.54 2.41 3.38 3.64 3.83 3.58 3.61 3.38 ... ## $ N02 : num [1:12] 0.2 0.13 0.08 0.1 0.21 0.3 0.23 0.28 0.18 0.24 ... ## $ PO : num [1:12] 0.2 0.14 0.09 0.18 0.23 0.28 0.32 0.38 0.36 0.34 ... ## $ Cu : num [1:12] 0.04 0.065 0.077 0.038 0.03 0.027 0.022 0.025 0.028 0.023 ... ## $ Al : num [1:12] 1.707 7.207 10.89 3.644 0.408 ... ## $ Fe : num [1:12] 2.176 7.595 11.37 4.471 0.434 ... ## $ Mu : num [1:12] 0.118 0.324 0.342 0.173 0.111 0.089 0.074 0.064 0.049 0.045 ... ## $ Pb : num [1:12] 0.024 0.081 0.079 0.056 0.015 0.02 0.013 0.015 0.022 0.012 ... ## $ Cd : num [1:12] 0.002 0.005 0.003 0.002 0.003 0.002 0.002 0.002 0.002 0.001 ... ## $ Zn : num [1:12] 0.372 0.611 0.641 0.343 0.468 0.323 0.273 0.28 0.28 0.171 ... ## $ As : num [1:12] 0.029 0.126 0.088 0.074 0.024 0.023 0.022 0.019 0.022 0.022 ... ## $ Colo : num [1:12] 178600 247014 208035 174967 160299 ... ## $ Cole : num [1:12] 74326 95332 90325 58096 63802 ... Convirtiendo en un dataframe: datosc=as.data.frame(datosc) rownames(datosc)&lt;- datosc$meses Eliminanos la variable meses(cualitativa) datosc$meses=NULL head(datosc,3) ## Caud Temp pH Turb CE OD SD Akal DI Cls so N03 N02 PO ## Ene 40.6 19.2 7.7 47.2 487.71 8.70 337.86 95.6 211.4 14.3 138.6 2.98 0.20 0.20 ## Feb 56.0 20.2 7.8 301.9 440.00 8.84 307.96 91.0 189.1 12.8 116.5 2.78 0.13 0.14 ## Mar 71.9 20.2 7.0 391.7 401.96 8.94 278.04 81.6 164.6 12.8 97.5 2.54 0.08 0.09 ## Cu Al Fe Mu Pb Cd Zn As Colo Cole ## Ene 0.040 1.707 2.176 0.118 0.024 0.002 0.372 0.029 178600 74326 ## Feb 0.065 7.207 7.595 0.324 0.081 0.005 0.611 0.126 247014 95332 ## Mar 0.077 10.890 11.370 0.342 0.079 0.003 0.641 0.088 208035 90325 ANALISIS EXPLORATORIO #Verificando si hay valores faltantes: #Detectando y graficando los % de datos perdidos #No hay valores perdidos en ninguna variable library(DataExplorer) library(ggplot2) plot_missing(datosc,ggtheme=theme_minimal()) #estandarizamos los datos porque las variables se encuentran en diferentes escalas datosc &lt;- as.data.frame(scale(datosc)) CLUSTER JERARQUICO AGLOMERATIVO Distanicia euclidiana y metodo de enlace Ward.D2 #----------------------------------- #calculando la matriz de disimilaridad d &lt;- dist(datosc, method = &quot;euclidean&quot;) #el metodo ward.d2 ,para reconstruir la matriz distancia res.hc &lt;- hclust(d, method = &quot;ward.D2&quot; ) #formacion de &quot;n&quot; cluster hasta 1 cluster #observamos que son 11 etapas: #En la etapa 1 #el individuo 10 y el individuo 11 forman un cluster #En la entapa 2 #el individuo 8 y el individuo 9 forman un cluster #y asi sucesivamente hasta llegar a la etapa 11 donde se #forma un solo cluster res.hc$merge ## [,1] [,2] ## [1,] -10 -11 ## [2,] -8 -9 ## [3,] -1 -12 ## [4,] -6 2 ## [5,] -7 4 ## [6,] -5 1 ## [7,] -2 -3 ## [8,] 3 6 ## [9,] -4 7 ## [10,] 5 8 ## [11,] 9 10 #estructura: str(res.hc) ## List of 7 ## $ merge : int [1:11, 1:2] -10 -8 -1 -6 -7 -5 -2 3 -4 5 ... ## $ height : num [1:11] 1.55 1.9 2.54 3.36 3.95 ... ## $ order : int [1:12] 4 2 3 7 6 8 9 1 12 5 ... ## $ labels : chr [1:12] &quot;Ene&quot; &quot;Feb&quot; &quot;Mar&quot; &quot;Abr&quot; ... ## $ method : chr &quot;ward.D2&quot; ## $ call : language hclust(d = d, method = &quot;ward.D2&quot;) ## $ dist.method: chr &quot;euclidean&quot; ## - attr(*, &quot;class&quot;)= chr &quot;hclust&quot; options(scipen = 999)#sin notacion cientifica #distancia res.hc$height ## [1] 1.554549 1.904331 2.540561 3.359679 3.950460 4.065524 4.075132 ## [8] 4.573464 7.031689 7.392952 18.178469 EL NUMERO DE CLUSTER #Hemos considerado que un cambio brusco seria de la etapa 9 #a la etapa 10,entonces el numero de cluster es 3 library(ggplot2) alturas &lt;- data.frame(etapa=1:11,distancia=res.hc$height)#distancia alturas ## etapa distancia ## 1 1 1.554549 ## 2 2 1.904331 ## 3 3 2.540561 ## 4 4 3.359679 ## 5 5 3.950460 ## 6 6 4.065524 ## 7 7 4.075132 ## 8 8 4.573464 ## 9 9 7.031689 ## 10 10 7.392952 ## 11 11 18.178469 #screeplot con las distancias ggplot(alturas) + aes(x=etapa,y=distancia) + geom_point() + geom_line() + scale_x_continuous(breaks=seq(1,15)) + geom_vline(xintercept = 9,col=&quot;red&quot;,lty=2) + theme_bw() # Dividir en 3 clusters grp &lt;- cutree(res.hc, k = 3) grp ## Ene Feb Mar Abr May Jun Ju! Ago Set Oct Nov Dic. ## 1 2 2 2 1 3 3 3 3 1 1 1 #cluster1: #enero,mayo,octubre,noviembre y diciembre #cluster2: #febrero,marzo,abril #cluster3: #junio,julio,agosto,setiembre #La asignacion de cada elemento(meses) a cada cluster DEDONGRAMA #visualizacion de los 3 cluster: library(factoextra) ## Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa fviz_dend(res.hc, k=3, cex = 0.5, k_colors = rainbow(3), # Colores del arco iris color_labels_by_k = TRUE, rect=T) GRAFICA#ACP con CLUSTER #Se puede apreciar que con 2 componentes retenemos 83.8% de la inercia total library(factoextra) fviz_cluster(list(data = datosc, cluster = grp), palette =c(&quot;#DB1515&quot;, &quot;#3722BF&quot;, &quot;#D41AC4&quot;) , ellipse.type = &quot;convex&quot;, # Concentration ellipse repel = T, # Avoid label overplotting (slow) show.clust.cent = FALSE, ggtheme = theme_bw()) # Juntando el archivo de &quot;datos&quot; con la columna de &quot;cluster&quot; datos.j &lt;- cbind(datosc,grp) str(datos.j) ## &#39;data.frame&#39;: 12 obs. of 25 variables: ## $ Caud: num 0.372 1.32 2.299 0.803 -0.508 ... ## $ Temp: num 0.621 1.275 1.275 1.21 0.163 ... ## $ pH : num 0.37 0.581 -1.11 -1.11 1.004 ... ## $ Turb: num -0.279 1.717 2.421 0.138 -0.551 ... ## $ CE : num -0.652 -1.227 -1.686 -1.391 0.642 ... ## $ OD : num -0.0477 0.8426 1.4785 -1.2559 -1.0015 ... ## $ SD : num -0.6264 -1.1037 -1.5813 -1.4788 0.0404 ... ## $ Akal: num -0.734 -1.089 -1.812 -1.065 1.174 ... ## $ DI : num -0.506 -1.09 -1.732 -1.434 0.631 ... ## $ Cls : num -0.732 -1.111 -1.111 -1.339 1.162 ... ## $ so : num -0.158 -1.197 -2.091 -1.287 0.223 ... ## $ N03 : num -0.507 -0.942 -1.464 -1.747 0.362 ... ## $ N02 : num 0.0753 -0.9789 -1.7319 -1.4307 0.2259 ... ## $ PO : num -0.644 -1.289 -1.825 -0.859 -0.322 ... ## $ Cu : num 0.28 1.659 2.32 0.17 -0.271 ... ## $ Al : num -0.175 1.453 2.543 0.398 -0.559 ... ## $ Fe : num -0.102 1.43 2.498 0.547 -0.594 ... ## $ Mu : num -0.0809 1.9183 2.093 0.4529 -0.1488 ... ## $ Pb : num -0.246 1.943 1.866 0.982 -0.592 ... ## $ Cd : num -0.15 2.542 0.748 -0.15 0.748 ... ## $ Zn : num 0.1606 1.7057 1.8997 -0.0269 0.7812 ... ## $ As : num -0.35 2.418 1.334 0.934 -0.492 ... ## $ Colo: num 0.1935 2.1774 1.047 0.0881 -0.3373 ... ## $ Cole: num 0.5239 1.6922 1.4137 -0.3787 -0.0613 ... ## $ grp : int 1 2 2 2 1 3 3 3 3 1 ... #convirtiendo en factor la varaible &quot;grp&quot; datos.j$grp &lt;- factor(datos.j$grp) str(datos.j) ## &#39;data.frame&#39;: 12 obs. of 25 variables: ## $ Caud: num 0.372 1.32 2.299 0.803 -0.508 ... ## $ Temp: num 0.621 1.275 1.275 1.21 0.163 ... ## $ pH : num 0.37 0.581 -1.11 -1.11 1.004 ... ## $ Turb: num -0.279 1.717 2.421 0.138 -0.551 ... ## $ CE : num -0.652 -1.227 -1.686 -1.391 0.642 ... ## $ OD : num -0.0477 0.8426 1.4785 -1.2559 -1.0015 ... ## $ SD : num -0.6264 -1.1037 -1.5813 -1.4788 0.0404 ... ## $ Akal: num -0.734 -1.089 -1.812 -1.065 1.174 ... ## $ DI : num -0.506 -1.09 -1.732 -1.434 0.631 ... ## $ Cls : num -0.732 -1.111 -1.111 -1.339 1.162 ... ## $ so : num -0.158 -1.197 -2.091 -1.287 0.223 ... ## $ N03 : num -0.507 -0.942 -1.464 -1.747 0.362 ... ## $ N02 : num 0.0753 -0.9789 -1.7319 -1.4307 0.2259 ... ## $ PO : num -0.644 -1.289 -1.825 -0.859 -0.322 ... ## $ Cu : num 0.28 1.659 2.32 0.17 -0.271 ... ## $ Al : num -0.175 1.453 2.543 0.398 -0.559 ... ## $ Fe : num -0.102 1.43 2.498 0.547 -0.594 ... ## $ Mu : num -0.0809 1.9183 2.093 0.4529 -0.1488 ... ## $ Pb : num -0.246 1.943 1.866 0.982 -0.592 ... ## $ Cd : num -0.15 2.542 0.748 -0.15 0.748 ... ## $ Zn : num 0.1606 1.7057 1.8997 -0.0269 0.7812 ... ## $ As : num -0.35 2.418 1.334 0.934 -0.492 ... ## $ Colo: num 0.1935 2.1774 1.047 0.0881 -0.3373 ... ## $ Cole: num 0.5239 1.6922 1.4137 -0.3787 -0.0613 ... ## $ grp : Factor w/ 3 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;: 1 2 2 2 1 3 3 3 3 1 ... #Si deseamos exportar : # write.csv(datos.j,&quot;Compras con Jerarquico Aglomerativo.csv&quot;) #CORROBORANDO # Análisis de Componentes Principales con el paquete ade4 library(ade4) #Usando 3 componentes acp &lt;- dudi.pca(datosc,scannf=FALSE,nf=3) summary(acp) ## Class: pca dudi ## Call: dudi.pca(df = datosc, scannf = FALSE, nf = 3) ## ## Total inertia: 24 ## ## Eigenvalues: ## Ax1 Ax2 Ax3 Ax4 Ax5 ## 17.7541 2.3548 1.3683 0.9189 0.5800 ## ## Projected inertia (%): ## Ax1 Ax2 Ax3 Ax4 Ax5 ## 73.976 9.812 5.701 3.829 2.417 ## ## Cumulative projected inertia (%): ## Ax1 Ax1:2 Ax1:3 Ax1:4 Ax1:5 ## 73.98 83.79 89.49 93.32 95.73 ## ## (Only 5 dimensions (out of 11) are shown) # Valores propios #el criterio de la media: #estamos trabajando con la matriz correlacion cada variable deberia retener #1% de la inercia total , nos quedamos con los 3 primeros autovalores #que son mayores a 1. acp$eig ## [1] 17.75412281 2.35476144 1.36828719 0.91885927 0.58004727 0.40691705 ## [7] 0.24251967 0.16344726 0.11008407 0.06970343 0.03125052 # con 3 componetes podemos explicar las demas variables #reteniendo 89.49% de la inercia total inertia.dudi(acp) ## Inertia information: ## Call: inertia.dudi(x = acp) ## ## Decomposition of total inertia: ## inertia cum cum(%) ## Ax1 17.75412 17.75 73.98 ## Ax2 2.35476 20.11 83.79 ## Ax3 1.36829 21.48 89.49 ## Ax4 0.91886 22.40 93.32 ## Ax5 0.58005 22.98 95.73 ## Ax6 0.40692 23.38 97.43 ## Ax7 0.24252 23.63 98.44 ## Ax8 0.16345 23.79 99.12 ## Ax9 0.11008 23.90 99.58 ## Ax10 0.06970 23.97 99.87 ## Ax11 0.03125 24.00 100.00 # Correlaciones entre las variables y los componentes acp$co[c(1,2,3)] ## Comp1 Comp2 Comp3 ## Caud -0.9856905 -0.01901796 0.07578045 ## Temp -0.8575730 0.34464942 -0.26784995 ## pH 0.1718367 0.32044552 -0.74235041 ## Turb -0.9346113 -0.23625366 0.04170687 ## CE 0.9441237 -0.27906809 -0.12008220 ## OD -0.2805474 -0.66047211 0.18988850 ## SD 0.9217281 -0.33148387 -0.01124840 ## Akal 0.9013802 -0.30784486 -0.16592703 ## DI 0.9190383 -0.32601318 -0.17526601 ## Cls 0.7834060 -0.44555826 -0.13405671 ## so 0.9720223 -0.12524082 -0.11183695 ## N03 0.8933136 -0.39175400 -0.02728335 ## N02 0.8656142 -0.26140158 -0.19080927 ## PO 0.9171172 0.02090579 0.18088859 ## Cu -0.9478302 -0.27917688 0.01341109 ## Al -0.9482153 -0.21768133 0.12213858 ## Fe -0.9559193 -0.19131422 0.14078444 ## Mu -0.9553130 -0.27329191 -0.04917357 ## Pb -0.9570670 -0.17625217 0.09659005 ## Cd -0.6493169 -0.55943616 -0.26456602 ## Zn -0.8225078 -0.45618080 -0.15216823 ## As -0.9213033 -0.15271183 -0.06553008 ## Colo -0.8002671 0.02046972 -0.42279859 ## Cole -0.7701392 -0.05606211 -0.45376503 ############## #componente1:# ############## #caudal #temp #Turb #CE #SD #Akal #Di #Cls #so #NO3 #NO2 #PO #Cu #Al #Fe #Mu #Pb #Cd #Zn #As #Colo #Cole ############## #componente2:# ############## #OD ############## #componente3:# ############## #pH # Segunda forma #podemos observar que todos los elementos estan asociados mas a la #dimension 1,excepto &quot;pH&quot; y &quot;OD&quot; que no se sabe con exactitud si pertenece #a la dimension 1 o a la dimension2 de manera visual, pero con nuestra matriz de #correlacion ya determinamos la variable &quot;pH&quot; pertenece al componente3 #y la variable &quot;OD&quot; pertenece al componente2 library(factoextra) fviz_pca_var(acp, col.var=&quot;steelblue&quot;)+theme_minimal() #biplot library(factoextra) fviz_pca_biplot(acp, repel = F, col.var = &quot;steelblue&quot;, col.ind = &quot;black&quot; ) # Grafica de Valores propios - ScreePlot #El primer componente retiene 74% de la inercia total #El segundo componete retiene 9.8% de la inercia total #El tercer componente retiene 5.7% de la inercia total fviz_eig(acp, addlabels=TRUE, hjust = -0.3, barfill=&quot;white&quot;, barcolor =&quot;darkblue&quot;, linecolor =&quot;red&quot;) + ylim(0,80) + theme_minimal() # Scores o Puntuaciones de cada individuo acp$li[1:10,] ## Axis1 Axis2 Axis3 ## Ene -1.127415 1.2241429 -0.4215330 ## Feb -7.321424 -1.5374149 -1.7252348 ## Mar -8.892270 -1.2061457 1.2481771 ## Abr -3.864966 2.5559978 1.5588401 ## May 1.653208 -0.3952227 -1.8173027 ## Jun 3.526615 -1.9367091 -0.4606773 ## Ju! 3.869064 -1.6735475 0.6922911 ## Ago 3.572872 -1.2874593 1.1904835 ## Set 2.750543 -0.5237799 1.5165983 ## Oct 2.683794 1.3317449 -0.4582014 # Gráfica de individuos sobre el primer plano de componentes s.label(acp$li,clabel=0.7,grid=FALSE,boxes=FALSE) "],["applications.html", "Chapter 1 Applications 1.1 Example one 1.2 Example two", " Chapter 1 Applications Some significant applications are demonstrated in this chapter. 1.1 Example one 1.2 Example two "],["final-words.html", "Chapter 2 Final Words", " Chapter 2 Final Words "],["references.html", "References", " References "]]
